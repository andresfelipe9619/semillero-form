<script>
  const adminAgreements = ["#becado", "#convenio_colegio"];

  function hideAdminData() {
    $("#modBusqueda").hide();
    showForm();
    hideAdminAgreements();
    hideInitialData();
  }

  function showSearchModule() {
    $("#modBusqueda").fadeIn();
    hideInitialData();
  }

  function hideAdminAgreements() {
    const agreements = adminAgreements.join(",");
    $(".radio-inline")
      .has(agreements)
      .hide();
    $(agreements).hide();
  }

  function hideInitialData() {
    $("#myForm #pdfConstanciaEstu").hide();
    $("#myForm #pdfContanciaFun").hide();
    $("#myForm #pdfRecibos").hide();
    $("#myForm #pdfCartaSolicitud").hide();
    $("#myForm #pdfActaGrado").hide();
    $("#myForm #modMatematicas").hide();
    $("#myForm #modMatematicas #checkboxMate")
      .children()
      .hide();
    $("#myForm #modFisica").hide();
    $("#myForm #modQuimica").hide();
    $("#myForm #modBiologia").hide();
    $("#myForm #modHumanidades").hide();
    $("#myForm #modArtes").hide();
    $("#myForm #modNas").hide();
  }
  const allowOnlyNumbers = e =>
    e.metaKey || // cmd/ctrl
    e.which <= 0 || // arrow keys
    e.which == 8 || // delete key
    /[0-9]/.test(String.fromCharCode(e.which)); // numbers

  const DoNotCopyPaste = e => e.preventDefault();

  function showFiles({ grade, estate }) {
    if (grade == 11 || grade === "EGRESADO") {
      $("#myForm #modNas").fadeIn();
      $("#myForm #pdfActaGrado").fadeOut();
    }

    if (grade === "EGRESADO") {
      $("#myForm #pdfActaGrado").fadeIn();
      $("#myForm #actaGrado").prop("disabled", false);
      $("#myForm #pdfConstanciaEstu").fadeOut();
      $("#myForm #constanciaEstudFile").prop("disabled", true);
    }
    if (grade !== "EGRESADO") {
      $("#myForm #pdfActaGrado").fadeOut();
      $("#myForm #actaGrado").prop("disabled", true);
      $("#myForm #pdfConstanciaEstu").fadeIn();
      $("#myForm #constanciaEstudFile").prop("disabled", false);
    }
    if (estate === "PRIVADO") {
      $("#myForm #pdfConstanciaEstu").fadeOut();
      $("#myForm #constanciaEstudFile").prop("disabled", true);
    }
  }

  function showModules(grade) {
    if (!(grade in modulesByGrades) || !modulesByGrades) return;
    Object.keys(modulesByGrades[grade]).map(module => {
      const courses = modulesByGrades[grade][module];
      return showModuleCourses({ courses, module });
    });
  }

  function buildModulesSelection(modules) {
    ` <div id="temaese" class="checkbox">
       <input
         type="radio"
         class="quimica"
         name="seleccion"
         id="ese"
         value="ese"
       />
       <label>ESE: Estequiometría II, Soluciones y Equilibrio</label>
     </div>`;
  }

  function showModuleCourses({ module, courses }) {
    const selector = `${moduleSelector(module)}`;
    $(`#myForm ${selector}`).fadeIn();
    $(`#myForm ${selector} .input-div`)
      .children()
      .fadeIn();
    if (!courses.length) return;
    const coursesSelector = courses
      .map(course => `#tema${course.codigo}`)
      .join(", ");
    $(`#myForm ${selector} .input-div`)
      .children()
      .not(coursesSelector)
      .hide();
  }

  function showCourse({ course, selector }) {
    const courseSelector = `#myForm ${selector} #${course.codigo}`;
    console.log("courseSelector", courseSelector);
    $(courseSelector).fadeIn();
  }

  function moduleSelector(module) {
    const selector = `#mod${module.charAt(0).toUpperCase()}${module.slice(1)}`;
    return selector;
  }

  function hideModules() {
    if (!modulesByGrades || !modulesByGrades["11"]) return;
    Object.keys(modulesByGrades["11"]).map(module => {
      $(`#myForm ${moduleSelector(module)}`).fadeOut();
    });
  }

  function hideFiles() {
    $("#myForm #pdfConstanciaEstu").hide();
    $("#myForm #pdfContanciaFun").hide();
    $("#myForm #pdfRecibos").hide();
    $("#myForm #pdfCartaSolicitud").hide();
    $("#myForm #pdfActaGrado").hide();
  }

  function showStudyCertificate() {
    $("#myForm #pdfConstanciaEstu").fadeIn();
    $("#myForm #constanciaEstudFile").prop("disabled", false);
  }

  function hideStudyCertificate() {
    $("#myForm #pdfConstanciaEstu").fadeOut();
    $("#myForm #constanciaEstudFile").prop("disabled", true);
  }

  function hideGraduateFiles() {
    $("#myForm #pdfActaGrado").fadeOut();
    $("#myForm #actaGrado").prop("disabled", true);
  }

  function showGraduateFiles() {
    $("#myForm #pdfActaGrado").fadeIn();
    $("#myForm #actaGrado").prop("disabled", false);
    $("#myForm #pdfConstanciaEstu").fadeOut();
    $("#myForm #constanciaEstudFile").prop("disabled", true);
  }

  function hideStudentRecord() {
    cleanForm();
    $("#myForm").css("display", "none");
  }

  function showForm() {
    $("#myForm").css("display", "block");
    $("#myForm #save").css("display", "block");
  }

  function showStudentRecord() {
    cleanForm();
    showForm();
    $("#myForm #edit").css("display", "none");
  }

  function cleanForm(reload) {
    $(".numeric").val("");
    $(".text-uppercase").val("");
    $(".text-lowercase").val("");

    $(".file").val("");
    $("input:checkbox").removeAttr("checked");
    // $('#curso_anterior').empty('');
    if (reload) window.location.reload(true);
  }

  let departments = ["CAUCA", "VALLE DEL CAUCA"];
  let citiesData = [];
  citiesData[0] = "";
  citiesData[1] =
    "Popayán|Cajibío|El tambo|La Sierra|Morales|Piendamó|Rosas|Soatá|Timbío|Buenos aires|Caloto|Corintio|Guachené|Miranda|Padilla|Puerto Tejada|Santander de Quilichao|Suárez|Villa rica|Almaguer|Argelia|Balboa|Bolílet|Florencia|La vega|Mercaderes|Patía|Piamonte|San Sebastián|Santa Rosa|Sucre|Guapí|López de micay|Timbiquí|Caldono|Inzá|Jambaló|Páez|Puracé|Silvia|Toribío|Torotó";
  citiesData[2] =
    "|Cali|Candelaria|Dagua|Florida|Jamundí|La Cumbre|Palmira|Pradera|Vijes|Yumbo|Andalucía|Buga|Bugalagrande|Calima-El Darién|El Cerrito|Ginebra|Guacarí|Restrepo|Riofrío|San Pedro|Trujillo|Tuluá|Yotoco|Buenaventura|Caicedonia|Sevilla|Cartago|El águila|El Cairo|El Dovio|La Unión|La Victoria|Obando|Restrepo|Rodalnillo|Toro|Ulloa|Versalles|Zarzal|Alcalá";
  const departmentElementId = "depto_res";
  const cityElementId = "ciudad_res";
  const communeElementId = "comuna_res";
  function populateDepartments() {
    let countryElement = document.getElementById(departmentElementId);
    countryElement.length = 0;
    countryElement.options[0] = new Option("Seleccione Departamento", "-1");
    countryElement.selectedIndex = 0;
    for (let department of departments) {
      countryElement.options[countryElement.length] = new Option(
        department,
        department
      );
    }
    if (cityElementId) {
      countryElement.onchange = function() {
        populateCities();
      };
    }
  }

  function populateCities() {
    let selectedDepartment = document.getElementById(departmentElementId)
      .selectedIndex;

    let citieElement = document.getElementById(cityElementId);

    citieElement.length = 0;
    citieElement.options[0] = new Option("Seleccione Ciudad", "");
    citieElement.selectedIndex = 0;

    let cities = (citiesData[selectedDepartment] || []).split("|");

    for (let citie of cities) {
      citieElement.options[citieElement.length] = new Option(
        citie,
        citie.toUpperCase()
      );
    }
    if (communeElementId) {
      citieElement.onchange = function() {
        populateCommunes();
      };
    }
  }

  function populateCommunes() {
    let selectedCitie = document.getElementById(cityElementId).selectedIndex;
    console.log("selectedCitie", selectedCitie);
    if (selectedCitie !== 2) return $(`#div-comuna`).addClass("oculto");
    $(`#div-comuna`).removeClass("oculto");
    let communeElement = document.getElementById(communeElementId);

    communeElement.length = 0;
    communeElement.options[0] = new Option("Seleccione Comuna", "");
    communeElement.selectedIndex = 0;
    const communes = Array.from({ length: 21 }, (v, i) => ++i);
    console.log("communes", communes);
    for (let commune of communes) {
      communeElement.options[communeElement.length] = new Option(
        String(commune),
        String(commune)
      );
    }
  }

  function setWaitCursor() {
    $("#btn-buscar").css("cursor", "wait");
    $("body").css("cursor", "wait");
  }

  function setDefaultCursor() {
    $("#btn-buscar").css("cursor", "");
    $("body").css("cursor", "");
  }

  function cleanArray(actual) {
    let newArray = [];
    for (let i = 0, j = actual.length; i < j; i++) {
      if (actual[i] != "") {
        newArray.push(actual[i]);
      }
    }
    return newArray;
  }
</script>
